function lyncImageAlt(s){$(s).hide()}if(String.prototype.format=function(){for(var s=this,e=0;e<arguments.length;e++){var a="{"+e+"}";s=s.replace(a,arguments[e])}return s},lync={control:null,html:'<div class="ms-Persona ms-Persona--offline ms-Persona--lg" id="{0}" data-sip="{1}"><div class="ms-Persona-imageArea"><div class="ms-Persona-initials ms-Persona-initials--blue">{2}</div><img class="ms-Persona-image large-img" onerror="lyncImageAlt(this)" src="{3}" alt="" /></div><div class="ms-Persona-presence"><i class="ms-Icon ms-Icon--checkboxCheck"></i><i class="ms-Icon ms-Icon--clock"></i>&#160;</div><div class="ms-Persona-details"><span class="ms-Persona-primaryText">{4}</span><br/><span class="ms-Persona-secondaryText">{5}</span><br/><span class="ms-Persona-tertiaryText">Presence Unknown</span></div></div>',init:function(){$(".lync-status").length>0?($(".lync-status").each(function(){var s=$(this),e={name:s.data("name"),sip:s.data("sip"),title:s.data("title"),image:s.data("image")};e.id=e.name.replace(/ /g,"_"),e.initials=e.name.split(" ")[0].substring(0,1)+e.name.split(" ")[e.name.split(" ").length-1].substring(0,1);var a=lync.html.format(e.id,e.sip,e.initials,e.image,e.name,e.title),o=document.createElement("div");$(o).addClass("persona"),$(o).html(a),$(o).insertAfter(s),s.hide()}),$(".ms-Persona").each(function(){lync.control.GetStatus($(this).data("sip"),$(this).attr("id"))})):console.log("No person details")}},window.ActiveXObject)lync.control=new ActiveXObject("Name.NameCtrl");else try{lync.control=new ActiveXObject("Name.NameCtrl")}catch(e){lync.control=function(s){var e=null;try{if(e=document.getElementById(s),!Boolean(e)&&Boolean(navigator.mimeTypes)&&navigator.mimeTypes[s]&&navigator.mimeTypes[s].enabledPlugin){var a=document.createElement("object");a.id=s,a.type=s,a.width="0",a.height="0",a.style.setProperty("visibility","hidden",""),document.body.appendChild(a),e=document.getElementById(s)}}catch(o){e=null}return e}("application/x-sharepoint-uc")}lync.control.OnStatusChange=function(s,e,a){switch(e){case 0:$("#"+a).removeClass("ms-Persona--offline").removeClass("ms-Persona--away").removeClass("ms-Persona--busy").removeClass("ms-Persona--dnd").removeClass("ms-Persona--ooo").addClass("ms-Persona--available"),$("#"+a+" .ms-Persona-tertiaryText").text("Available");break;case 1:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--away").removeClass("ms-Persona--busy").removeClass("ms-Persona--dnd").removeClass("ms-Persona--ooo").addClass("ms-Persona--offline"),$("#"+a+" .ms-Persona-tertiaryText").text("Offline");break;case 2:case 16:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--busy").removeClass("ms-Persona--dnd").removeClass("ms-Persona--ooo").addClass("ms-Persona--away"),$("#"+a+" .ms-Persona-tertiaryText").text("Away");break;case 3:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--away").removeClass("ms-Persona--dnd").removeClass("ms-Persona--ooo").addClass("ms-Persona--busy"),$("#"+a+" .ms-Persona-tertiaryText").text("Busy");break;case 4:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--busy").removeClass("ms-Persona--dnd").removeClass("ms-Persona--ooo").addClass("ms-Persona--away"),$("#"+a+" .ms-Persona-tertiaryText").text("Be right back");break;case 5:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--away").removeClass("ms-Persona--dnd").removeClass("ms-Persona--ooo").addClass("ms-Persona--busy"),$("#"+a+" .ms-Persona-tertiaryText").text("In a call");break;case 6:case 7:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--away").removeClass("ms-Persona--dnd").removeClass("ms-Persona--ooo").addClass("ms-Persona--busy"),$("#"+a+" .ms-Persona-tertiaryText").text("In a meeting");break;case 8:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--busy").removeClass("ms-Persona--away").removeClass("ms-Persona--dnd").addClass("ms-Persona--ooo"),$("#"+a+" .ms-Persona-tertiaryText").text("Out of Office");break;case 9:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--away").removeClass("ms-Persona--busy").removeClass("ms-Persona--ooo").addClass("ms-Persona--dnd"),$("#"+a+" .ms-Persona-tertiaryText").text("Do not disturb");break;case 10:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--away").removeClass("ms-Persona--dnd").removeClass("ms-Persona--ooo").addClass("ms-Persona--busy"),$("#"+a+" .ms-Persona-tertiaryText").text("In a conference call");break;case 15:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--away").removeClass("ms-Persona--busy").removeClass("ms-Persona--ooo").addClass("ms-Persona--dnd"),$("#"+a+" .ms-Persona-tertiaryText").text("Do Not Disturb");break;case 18:$("#"+a).removeClass("ms-Persona--available").removeClass("ms-Persona--offline").removeClass("ms-Persona--away").removeClass("ms-Persona--busy").removeClass("ms-Persona--ooo").addClass("ms-Persona--dnd"),$("#"+a+" .ms-Persona-tertiaryText").text("Presenting")}},$("body").on("mouseover",".ms-Persona",function(){lync.control.ShowOOUI($(this).data("sip"),0,10,10)}),$("body").on("mouseout",".ms-Persona",function(){lync.control.HideOOUI()});